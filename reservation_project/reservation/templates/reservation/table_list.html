{% extends 'base.html' %}

{% block content %}
  <h2>Choose Reservation Date</h2>
  <form method="post" id="reservation-form">
    {% csrf_token %}
    {{ form.as_p }}
    <button type="submit">Show Tables</button>
  </form>

  {% if date %}
    <h2>Available Tables on {{ date }}</h2>
    <div id="hall-layout">  
      {% for table in tables %}
        {% with is_table_reserved=table.is_reserved date=date %}
          {% if not is_table_reserved %}
            <form method="post" action="{% url 'reserve_table' table.id %}" class="reserve-form">
              {% csrf_token %}
              <input type="hidden" name="date" value="{{ date|date:'Y-m-d' }}">
              <input type="hidden" name="table_number" value="{{ table.number }}">
              <input type="hidden" name="table_seats" value="{{ table.seats }}">
              <button type="submit" class="reserve-button">
                Reserve Table {{ table.number }} - {{ table.seats }} seats
              </button>
            </form>
          {% endif %}
        {% endwith %}
      {% endfor %}
    </div>
  {% endif %}
{% endblock %}
